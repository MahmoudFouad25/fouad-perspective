<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>معاينة الدورة - منظور الفؤاد</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Video.js for Video Player -->
    <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
    <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
    
    <style>
        :root {
            --primary: #f4c430;
            --primary-dark: #e6b429;
            --secondary: #2196f3;
            --success: #4caf50;
            --danger: #ff4444;
            --warning: #ff9800;
            --info: #00bcd4;
            --dark: #1a1a1a;
            --darker: #0f0f0f;
            --light: #2a2a2a;
            --lighter: #3a3a3a;
            --text: #e0e0e0;
            --text-muted: #999;
            --border: rgba(255, 255, 255, 0.1);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            --radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Kufi Arabic', sans-serif;
            background: var(--darker);
            color: var(--text);
            overflow-x: hidden;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--lighter);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Preview Header */
        .preview-header {
            position: sticky;
            top: 0;
            background: var(--dark);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            z-index: 1000;
            backdrop-filter: blur(10px);
            background: rgba(26, 26, 26, 0.95);
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .back-btn {
            width: 40px;
            height: 40px;
            background: var(--lighter);
            border: none;
            border-radius: 10px;
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .back-btn:hover {
            background: var(--primary);
            color: var(--dark);
            transform: translateX(3px);
        }

        .preview-badge {
            background: var(--warning);
            color: var(--dark);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .device-toggle {
            display: flex;
            background: var(--lighter);
            border-radius: 8px;
            padding: 0.25rem;
        }

        .device-btn {
            padding: 0.5rem 0.8rem;
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 6px;
            transition: var(--transition);
            font-size: 1.1rem;
        }

        .device-btn.active {
            background: var(--dark);
            color: var(--primary);
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-family: inherit;
            text-decoration: none;
            color: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--dark);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(244, 196, 48, 0.4);
        }

        .btn-secondary {
            background: var(--lighter);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Preview Container */
        .preview-container {
            position: relative;
            min-height: calc(100vh - 80px);
            display: flex;
            justify-content: center;
            padding: 2rem;
            transition: var(--transition);
        }

        .preview-frame {
            width: 100%;
            max-width: 1400px;
            background: var(--dark);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        /* Device Preview Modes */
        .preview-container.tablet-view .preview-frame {
            max-width: 768px;
        }

        .preview-container.mobile-view .preview-frame {
            max-width: 375px;
        }

        /* Course Hero Section */
        .course-hero {
            position: relative;
            background: linear-gradient(135deg, var(--lighter), var(--light));
            padding: 4rem 3rem;
            overflow: hidden;
        }

       .hero-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.3;
    background: linear-gradient(135deg, var(--primary), var(--primary-dark), var(--secondary));
    background-size: cover;
    background-position: center;
    filter: blur(5px);
}

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
        }

        .course-category {
            display: inline-block;
            background: rgba(244, 196, 48, 0.2);
            color: var(--primary);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .course-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text);
            line-height: 1.3;
        }

        .course-subtitle {
            font-size: 1.2rem;
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

        .hero-stats {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .hero-stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-muted);
        }

        .hero-stat i {
            color: var(--primary);
        }

        .instructor-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .instructor-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--dark);
        }

        .instructor-details h4 {
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .instructor-details p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Course Content Container */
        .course-content-container {
            display: flex;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            min-width: 0;
        }

        /* Content Tabs */
        .content-tabs {
            background: var(--light);
            border-radius: var(--radius);
            padding: 0.5rem;
            margin-bottom: 2rem;
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 0.8rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 8px;
            transition: var(--transition);
            white-space: nowrap;
            font-weight: 500;
            font-family: inherit;
        }

        .tab-btn:hover {
            color: var(--text);
        }

        .tab-btn.active {
            background: var(--dark);
            color: var(--primary);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* About Section */
        .about-section {
            background: var(--light);
            padding: 2rem;
            border-radius: var(--radius);
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .description-content {
            line-height: 1.8;
            color: var(--text-muted);
        }

        /* Learning Objectives */
        .objectives-section {
            background: var(--light);
            padding: 2rem;
            border-radius: var(--radius);
            margin-bottom: 2rem;
        }

        .objectives-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .objective-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: var(--dark);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .objective-icon {
            width: 40px;
            height: 40px;
            background: rgba(244, 196, 48, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            flex-shrink: 0;
        }

        /* Curriculum Section */
        .curriculum-section {
            background: var(--light);
            padding: 2rem;
            border-radius: var(--radius);
        }

        .module-item {
            margin-bottom: 1rem;
            background: var(--dark);
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .module-header {
            padding: 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .module-header:hover {
            background: rgba(244, 196, 48, 0.05);
        }

        .module-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .module-number {
            width: 35px;
            height: 35px;
            background: var(--primary);
            color: var(--dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .module-info h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .module-info p {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .module-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .module-content {
            padding: 0 1.2rem 1.2rem;
            display: none;
        }

        .module-item.expanded .module-content {
            display: block;
        }

        .module-item.expanded .fa-chevron-down {
            transform: rotate(180deg);
        }

        .lesson-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: var(--lighter);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .lesson-item:hover {
            transform: translateX(-5px);
            background: rgba(244, 196, 48, 0.1);
        }

        .lesson-icon {
            width: 40px;
            height: 40px;
            background: rgba(244, 196, 48, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }

        .lesson-info {
            flex: 1;
        }

        .lesson-title {
            font-weight: 500;
            margin-bottom: 0.2rem;
        }

        .lesson-duration {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .lesson-status {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--success);
        }

        .lesson-status.completed {
            background: var(--success);
            border-color: var(--success);
        }

        .lesson-status.completed::after {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 0.8rem;
            color: white;
        }

        /* Sidebar */
        .course-sidebar {
            width: 350px;
            flex-shrink: 0;
        }

        .sidebar-card {
            background: var(--light);
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
        }

        .price-section {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .price-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .price-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.3rem;
        }

        .price-currency {
            font-size: 1.2rem;
            font-weight: 400;
        }

        .original-price {
            text-decoration: line-through;
            color: var(--text-muted);
            font-size: 1.2rem;
        }

        .discount-badge {
            display: inline-block;
            background: var(--danger);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        .enroll-btn {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .course-features {
            list-style: none;
            padding: 0;
        }

        .course-features li {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.8rem 0;
            border-bottom: 1px solid var(--border);
        }

        .course-features li:last-child {
            border-bottom: none;
        }

        .course-features i {
            color: var(--primary);
            width: 20px;
        }

        /* Reviews Section */
        .reviews-section {
            background: var(--light);
            padding: 2rem;
            border-radius: var(--radius);
            margin-bottom: 2rem;
        }

        .rating-summary {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            padding: 2rem;
            background: var(--dark);
            border-radius: var(--radius);
        }

        .rating-average {
            text-align: center;
            padding-left: 2rem;
            border-left: 1px solid var(--border);
        }

        .rating-number {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary);
        }

        .rating-stars {
            color: var(--primary);
            margin: 0.5rem 0;
        }

        .rating-count {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .rating-breakdown {
            flex: 1;
        }

        .rating-bar {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .rating-bar span {
            width: 30px;
            text-align: center;
        }

        .rating-progress {
            flex: 1;
            height: 8px;
            background: var(--darker);
            border-radius: 4px;
            overflow: hidden;
        }

        .rating-progress-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.5s ease;
        }

        .rating-percentage {
            width: 40px;
            text-align: left;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        /* Review Item */
        .review-item {
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--border);
        }

        .review-item:last-child {
            border-bottom: none;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .reviewer-info {
            display: flex;
            gap: 1rem;
        }

        .reviewer-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--lighter);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--primary);
        }

        .reviewer-details h4 {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .review-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .review-stars {
            color: var(--primary);
        }

        .review-content {
            color: var(--text-muted);
            line-height: 1.7;
        }

        /* Instructor Tab */
        .instructor-tab-content {
            background: var(--light);
            padding: 2rem;
            border-radius: var(--radius);
        }

        .instructor-profile {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .instructor-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 700;
            color: var(--dark);
            flex-shrink: 0;
        }

        .instructor-bio h2 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .instructor-title {
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .instructor-stats {
            display: flex;
            gap: 2rem;
            margin: 1.5rem 0;
        }

        .instructor-stat {
            text-align: center;
        }

        .instructor-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .instructor-stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .instructor-description {
            line-height: 1.8;
            color: var(--text-muted);
        }

        /* FAQ Section */
        .faq-section {
            background: var(--light);
            padding: 2rem;
            border-radius: var(--radius);
        }

        .faq-item {
            margin-bottom: 1rem;
            background: var(--dark);
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .faq-question {
            padding: 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
            font-weight: 500;
        }

        .faq-question:hover {
            background: rgba(244, 196, 48, 0.05);
        }

        .faq-answer {
            padding: 0 1.2rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .faq-answer-content {
            padding-bottom: 1.2rem;
            color: var(--text-muted);
            line-height: 1.7;
        }

        .faq-item.active .faq-answer {
            max-height: 500px;
        }

        .faq-item.active .fa-plus {
            transform: rotate(45deg);
        }

        /* Video Player Modal */
        .video-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 2rem;
        }

        .video-modal.active {
            display: flex;
        }

        .video-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            background: var(--dark);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .video-header {
            padding: 1rem 1.5rem;
            background: var(--light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-title {
            font-weight: 600;
        }

        .close-video {
            background: none;
            border: none;
            color: var(--text);
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: var(--transition);
        }

        .close-video:hover {
            background: var(--lighter);
            color: var(--primary);
        }

        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
        }

        .video-wrapper video,
        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Admin Controls */
        .admin-controls {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            border: 1px solid var(--border);
            border-radius: 50px;
            padding: 0.5rem;
            display: flex;
            gap: 0.5rem;
            box-shadow: var(--shadow);
            z-index: 1000;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--lighter);
            border: none;
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-size: 1.2rem;
        }

        .control-btn:hover {
            background: var(--primary);
            color: var(--dark);
            transform: translateY(-2px);
        }

        .control-btn.active {
            background: var(--primary);
            color: var(--dark);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .course-content-container {
                flex-direction: column;
            }

            .course-sidebar {
                width: 100%;
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .preview-header {
                padding: 1rem;
            }

            .header-container {
                gap: 0.5rem;
            }

            .device-toggle {
                display: none;
            }

            .course-hero {
                padding: 2rem 1.5rem;
            }

            .course-title {
                font-size: 1.8rem;
            }

            .course-content-container {
                padding: 1rem;
            }

            .content-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .rating-summary {
                flex-direction: column;
                gap: 1rem;
            }

            .rating-average {
                border-left: none;
                border-top: 1px solid var(--border);
                padding-left: 0;
                padding-top: 1rem;
            }

            .instructor-profile {
                flex-direction: column;
                text-align: center;
            }

            .instructor-image {
                margin: 0 auto;
            }
        }

        /* Loading State */
        .loading-skeleton {
            background: linear-gradient(90deg, var(--lighter) 25%, var(--light) 50%, var(--lighter) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-text {
            height: 20px;
            margin-bottom: 10px;
        }

        .skeleton-title {
            height: 40px;
            margin-bottom: 20px;
            width: 70%;
        }

        .skeleton-image {
            height: 200px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- Preview Header -->
    <header class="preview-header">
        <div class="header-container">
            <div class="header-left">
                <button class="back-btn" onclick="goBack()">
                    <i class="fas fa-arrow-right"></i>
                </button>
                <span class="preview-badge">
                    <i class="fas fa-eye"></i>
                    وضع المعاينة
                </span>
            </div>
            
            <div class="header-actions">
                <div class="device-toggle">
                    <button class="device-btn active" onclick="setDevice('desktop')">
                        <i class="fas fa-desktop"></i>
                    </button>
                    <button class="device-btn" onclick="setDevice('tablet')">
                        <i class="fas fa-tablet-alt"></i>
                    </button>
                    <button class="device-btn" onclick="setDevice('mobile')">
                        <i class="fas fa-mobile-alt"></i>
                    </button>
                </div>
                
                <a href="./course-builder.html?id=1" class="btn btn-secondary">
                    <i class="fas fa-edit"></i>
                    تعديل الدورة
                </a>
                
                <button class="btn btn-primary" onclick="publishCourse()">
                    <i class="fas fa-rocket"></i>
                    نشر الدورة
                </button>
            </div>
        </div>
    </header>

    <!-- Preview Container -->
    <div class="preview-container" id="previewContainer">
        <div class="preview-frame">
            <!-- Course Hero -->
            <section class="course-hero">
                <div class="hero-background"></div>
                <div class="hero-content">
                    <span class="course-category">تطوير الذات</span>
                    <h1 class="course-title">رحلة اكتشاف الذات بمنظور الفؤاد</h1>
                    <p class="course-subtitle">رحلة تحولية عميقة لفهم النفس البشرية من خلال منظور الفؤاد المتكامل</p>
                    
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <i class="fas fa-users"></i>
                            <span>156 طالب مسجل</span>
                        </div>
                        <div class="hero-stat">
                            <i class="fas fa-star"></i>
                            <span>4.9 (23 تقييم)</span>
                        </div>
                        <div class="hero-stat">
                            <i class="fas fa-clock"></i>
                            <span>12 ساعة محتوى</span>
                        </div>
                        <div class="hero-stat">
                            <i class="fas fa-language"></i>
                            <span>اللغة العربية</span>
                        </div>
                    </div>
                    
                    <div class="instructor-info">
                        <div class="instructor-avatar">م</div>
                        <div class="instructor-details">
                            <h4>م. محمود فؤاد</h4>
                            <p>خبير في منظور الفؤاد والتنمية البشرية</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Course Content -->
            <div class="course-content-container">
                <!-- Main Content -->
                <div class="main-content">
                    <!-- Content Tabs -->
                    <div class="content-tabs">
                        <button class="tab-btn active" onclick="showTab('overview')">
                            <i class="fas fa-info-circle"></i> نظرة عامة
                        </button>
                        <button class="tab-btn" onclick="showTab('curriculum')">
                            <i class="fas fa-list"></i> المنهج
                        </button>
                        <button class="tab-btn" onclick="showTab('reviews')">
                            <i class="fas fa-star"></i> التقييمات
                        </button>
                        <button class="tab-btn" onclick="showTab('instructor')">
                            <i class="fas fa-user-tie"></i> المدرب
                        </button>
                        <button class="tab-btn" onclick="showTab('faq')">
                            <i class="fas fa-question-circle"></i> الأسئلة الشائعة
                        </button>
                    </div>

                    <!-- Overview Tab -->
                    <div class="tab-content active" id="overview-tab">
                        <!-- About Section -->
                        <div class="about-section">
                            <h2 class="section-title">
                                <i class="fas fa-book-open"></i>
                                عن الدورة
                            </h2>
                            <div class="description-content">
                                <p>هذه الدورة هي رحلة تحولية عميقة تأخذك في استكشاف شامل لنفسك من خلال منظور الفؤاد المتكامل. ستتعلم كيف تفهم طبيعتك البشرية بشكل أعمق وتكتشف الطريق من الظلمات إلى النور.</p>
                                <p>من خلال 9 أنماط رئيسية و40 درساً تفاعلياً، ستتمكن من:</p>
                                <ul style="margin: 1rem 2rem; line-height: 1.8;">
                                    <li>فهم نمطك الشخصي وكيف يؤثر على حياتك</li>
                                    <li>اكتشاف الأقنعة التي ترتديها والتحرر منها</li>
                                    <li>بناء علاقات أصيلة وواعية</li>
                                    <li>تطوير ذاتك بطريقة متوازنة وشاملة</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Learning Objectives -->
                        <div class="objectives-section">
                            <h2 class="section-title">
                                <i class="fas fa-bullseye"></i>
                                ماذا ستتعلم
                            </h2>
                            <div class="objectives-grid">
                                <div class="objective-item">
                                    <div class="objective-icon">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <div>
                                        <h4>فهم البنية الرباعية للنفس</h4>
                                        <p>ستتعلم كيف تعمل النفس والفؤاد والصدر والقلب معاً</p>
                                    </div>
                                </div>
                                <div class="objective-item">
                                    <div class="objective-icon">
                                        <i class="fas fa-masks-theater"></i>
                                    </div>
                                    <div>
                                        <h4>كشف الأقنعة والتحرر منها</h4>
                                        <p>ستكتشف الأقنعة التي ترتديها وتتعلم كيف تعيش بأصالة</p>
                                    </div>
                                </div>
                                <div class="objective-item">
                                    <div class="objective-icon">
                                        <i class="fas fa-heart"></i>
                                    </div>
                                    <div>
                                        <h4>تحديد شوقك النبيل</h4>
                                        <p>ستكتشف شوقك الأصيل وتتعلم كيف تعيش منه</p>
                                    </div>
                                </div>
                                <div class="objective-item">
                                    <div class="objective-icon">
                                        <i class="fas fa-route"></i>
                                    </div>
                                    <div>
                                        <h4>رسم خريطة التحول الشخصي</h4>
                                        <p>ستضع خطة واضحة للانتقال من الظلمات إلى النور</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Curriculum Tab -->
                    <div class="tab-content" id="curriculum-tab">
                        <div class="curriculum-section">
                            <h2 class="section-title">
                                <i class="fas fa-list"></i>
                                منهج الدورة
                            </h2>
                            
                            <!-- Module 1 -->
                            <div class="module-item expanded">
                                <div class="module-header" onclick="toggleModule(this)">
                                    <div class="module-title">
                                        <div class="module-number">1</div>
                                        <div class="module-info">
                                            <h3>مقدمة في منظور الفؤاد</h3>
                                            <p>فهم الأساسيات والمفاهيم الرئيسية</p>
                                        </div>
                                    </div>
                                    <div class="module-meta">
                                        <span><i class="fas fa-video"></i> 5 دروس</span>
                                        <span><i class="fas fa-clock"></i> 2 ساعة</span>
                                        <i class="fas fa-chevron-down"></i>
                                    </div>
                                </div>
                                <div class="module-content">
                                    <div class="lesson-item" onclick="playLesson('intro-1')">
                                        <div class="lesson-icon">
                                            <i class="fas fa-play"></i>
                                        </div>
                                        <div class="lesson-info">
                                            <div class="lesson-title">مرحباً بك في رحلة اكتشاف الذات</div>
                                            <div class="lesson-duration">15 دقيقة</div>
                                        </div>
                                        <div class="lesson-status completed"></div>
                                    </div>
                                    <div class="lesson-item" onclick="playLesson('intro-2')">
                                        <div class="lesson-icon">
                                            <i class="fas fa-play"></i>
                                        </div>
                                        <div class="lesson-info">
                                            <div class="lesson-title">البنية الرباعية للنفس البشرية</div>
                                            <div class="lesson-duration">25 دقيقة</div>
                                        </div>
                                        <div class="lesson-status"></div>
                                    </div>
                                    <div class="lesson-item" onclick="playLesson('intro-3')">
                                        <div class="lesson-icon">
                                            <i class="fas fa-file-alt"></i>
                                        </div>
                                        <div class="lesson-info">
                                            <div class="lesson-title">قراءة: طريق النور وطريق الظلمات</div>
                                            <div class="lesson-duration">20 دقيقة</div>
                                        </div>
                                        <div class="lesson-status"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Module 2 -->
                            <div class="module-item">
                                <div class="module-header" onclick="toggleModule(this)">
                                    <div class="module-title">
                                        <div class="module-number">2</div>
                                        <div class="module-info">
                                            <h3>الأنماط التسعة</h3>
                                            <p>استكشاف الأنماط وخصائصها</p>
                                        </div>
                                    </div>
                                    <div class="module-meta">
                                        <span><i class="fas fa-video"></i> 9 دروس</span>
                                        <span><i class="fas fa-clock"></i> 4.5 ساعة</span>
                                        <i class="fas fa-chevron-down"></i>
                                    </div>
                                </div>
                                <div class="module-content">
                                    <!-- دروس الوحدة -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reviews Tab -->
                    <div class="tab-content" id="reviews-tab">
                        <div class="reviews-section">
                            <h2 class="section-title">
                                <i class="fas fa-star"></i>
                                تقييمات الطلاب
                            </h2>
                            
                            <div class="rating-summary">
                                <div class="rating-average">
                                    <div class="rating-number">4.9</div>
                                    <div class="rating-stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <div class="rating-count">23 تقييم</div>
                                </div>
                                
                                <div class="rating-breakdown">
                                    <div class="rating-bar">
                                        <span>5</span>
                                        <div class="rating-progress">
                                            <div class="rating-progress-fill" style="width: 85%"></div>
                                        </div>
                                        <span class="rating-percentage">85%</span>
                                    </div>
                                    <div class="rating-bar">
                                        <span>4</span>
                                        <div class="rating-progress">
                                            <div class="rating-progress-fill" style="width: 10%"></div>
                                        </div>
                                        <span class="rating-percentage">10%</span>
                                    </div>
                                    <div class="rating-bar">
                                        <span>3</span>
                                        <div class="rating-progress">
                                            <div class="rating-progress-fill" style="width: 5%"></div>
                                        </div>
                                        <span class="rating-percentage">5%</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Review Items -->
                            <div class="review-item">
                                <div class="review-header">
                                    <div class="reviewer-info">
                                        <div class="reviewer-avatar">أ</div>
                                        <div class="reviewer-details">
                                            <h4>أحمد محمد</h4>
                                            <div class="review-meta">
                                                <span class="review-stars">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                </span>
                                                <span>منذ أسبوع</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="review-content">
                                    <p>دورة رائعة بكل المقاييس! المحتوى عميق ومفيد جداً، والمدرب يشرح بطريقة واضحة وسلسة. استفدت كثيراً في فهم نفسي وتحسين علاقاتي.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Instructor Tab -->
                    <div class="tab-content" id="instructor-tab">
                        <div class="instructor-tab-content">
                            <h2 class="section-title">
                                <i class="fas fa-user-tie"></i>
                                عن المدرب
                            </h2>
                            
                            <div class="instructor-profile">
                                <div class="instructor-image">م</div>
                                <div class="instructor-bio">
                                    <h2>م. محمود فؤاد</h2>
                                    <p class="instructor-title">مؤسس منظور الفؤاد المتكامل</p>
                                    
                                    <div class="instructor-stats">
                                        <div class="instructor-stat">
                                            <div class="instructor-stat-value">15</div>
                                            <div class="instructor-stat-label">دورة</div>
                                        </div>
                                        <div class="instructor-stat">
                                            <div class="instructor-stat-value">1,234</div>
                                            <div class="instructor-stat-label">طالب</div>
                                        </div>
                                        <div class="instructor-stat">
                                            <div class="instructor-stat-value">4.9</div>
                                            <div class="instructor-stat-label">التقييم</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="instructor-description">
                                <p>مهندس ومدرب متخصص في التنمية البشرية من خلال منظور الفؤاد المتكامل. لديه خبرة تزيد عن 10 سنوات في مجال التدريب والإرشاد الشخصي.</p>
                                <p>طور منظور الفؤاد المتكامل الذي يجمع بين الحكمة الشرقية والعلوم النفسية الحديثة لفهم النفس البشرية بشكل أعمق.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ Tab -->
                    <div class="tab-content" id="faq-tab">
                        <div class="faq-section">
                            <h2 class="section-title">
                                <i class="fas fa-question-circle"></i>
                                الأسئلة الشائعة
                            </h2>
                            
                            <div class="faq-item">
                                <div class="faq-question" onclick="toggleFAQ(this)">
                                    <span>هل أحتاج لخبرة سابقة للالتحاق بالدورة؟</span>
                                    <i class="fas fa-plus"></i>
                                </div>
                                <div class="faq-answer">
                                    <div class="faq-answer-content">
                                        لا، الدورة مصممة للمبتدئين والمتقدمين على حد سواء. نبدأ من الأساسيات ونتدرج في المستوى.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="faq-item">
                                <div class="faq-question" onclick="toggleFAQ(this)">
                                    <span>كم المدة المتاحة للوصول للدورة؟</span>
                                    <i class="fas fa-plus"></i>
                                </div>
                                <div class="faq-answer">
                                    <div class="faq-answer-content">
                                        الوصول للدورة متاح مدى الحياة بمجرد التسجيل، مع جميع التحديثات المستقبلية مجاناً.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <aside class="course-sidebar">
                    <!-- Price Card -->
                    <div class="sidebar-card">
                        <div class="price-section">
                            <div class="price-label">سعر الدورة</div>
                            <div class="price-value">
                                299 <span class="price-currency">ر.س</span>
                            </div>
                            <div class="original-price">399 ر.س</div>
                            <div class="discount-badge">خصم 25%</div>
                        </div>
                        
                        <button class="btn btn-primary enroll-btn">
                            <i class="fas fa-shopping-cart"></i>
                            سجل الآن
                        </button>
                        
                        <ul class="course-features">
                            <li>
                                <i class="fas fa-infinity"></i>
                                <span>وصول مدى الحياة</span>
                            </li>
                            <li>
                                <i class="fas fa-mobile-alt"></i>
                                <span>متاح على جميع الأجهزة</span>
                            </li>
                            <li>
                                <i class="fas fa-certificate"></i>
                                <span>شهادة إتمام</span>
                            </li>
                            <li>
                                <i class="fas fa-comments"></i>
                                <span>دعم مباشر من المدرب</span>
                            </li>
                            <li>
                                <i class="fas fa-sync"></i>
                                <span>تحديثات مجانية</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Course Info Card -->
                    <div class="sidebar-card">
                        <h3 style="margin-bottom: 1rem;">معلومات الدورة</h3>
                        <ul class="course-features">
                            <li>
                                <i class="fas fa-signal"></i>
                                <span>المستوى: جميع المستويات</span>
                            </li>
                            <li>
                                <i class="fas fa-users"></i>
                                <span>156 طالب مسجل</span>
                            </li>
                            <li>
                                <i class="fas fa-language"></i>
                                <span>اللغة: العربية</span>
                            </li>
                            <li>
                                <i class="fas fa-calendar"></i>
                                <span>آخر تحديث: يناير 2025</span>
                            </li>
                        </ul>
                    </div>
                </aside>
            </div>
        </div>
    </div>

    <!-- Admin Controls -->
    <div class="admin-controls">
        <button class="control-btn" onclick="toggleStudentView()" title="عرض كطالب">
            <i class="fas fa-user-graduate"></i>
        </button>
        <button class="control-btn" onclick="showAnalytics()" title="التحليلات">
            <i class="fas fa-chart-line"></i>
        </button>
        <button class="control-btn" onclick="editCourse()" title="تعديل">
            <i class="fas fa-edit"></i>
        </button>
        <button class="control-btn" onclick="toggleSettings()" title="الإعدادات">
            <i class="fas fa-cog"></i>
        </button>
    </div>

    <!-- Video Modal -->
    <div class="video-modal" id="videoModal">
        <div class="video-container">
            <div class="video-header">
                <h3 class="video-title" id="videoTitle">عنوان الدرس</h3>
                <button class="close-video" onclick="closeVideo()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="video-wrapper">
                <video id="courseVideo" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="auto">
                    <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                </video>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="../js/firebase-config.js"></script>
    
    <script>
    // حماية الصفحة
    window.firebaseAuth.protectAdminPage();

    // متغيرات عامة
    let currentDevice = 'desktop';
    let currentTab = 'overview';
    let videoPlayer = null;
    let currentCourseId = null;

    // تهيئة الصفحة
    document.addEventListener('DOMContentLoaded', function() {
        initializeVideoPlayer();
        loadCourseData();
    });

    // تهيئة مشغل الفيديو
    function initializeVideoPlayer() {
        videoPlayer = videojs('courseVideo', {
            controls: true,
            fluid: true,
            playbackRates: [0.5, 1, 1.5, 2]
        });
    }

    // تحميل بيانات الدورة
// تحميل بيانات الدورة
async function loadCourseData() {
    const urlParams = new URLSearchParams(window.location.search);
    const courseId = urlParams.get('id');
    const courseSlug = urlParams.get('slug');
    
    if (!courseId && !courseSlug) {
        Swal.fire({
            icon: 'error',
            title: 'خطأ',
            text: 'لم يتم تحديد الدورة',
            confirmButtonColor: '#f4c430'
        }).then(() => {
            window.location.href = './courses.html';
        });
        return;
    }
    
    currentCourseId = courseId;
    
    try {
        // عرض حالة التحميل
        showLoadingState();
        
        let course = null;
        
        // جرب أولاً بالـ slug إذا كان موجود
        if (courseSlug) {
            const coursesSnapshot = await firebase.firestore()
                .collection('courses')
                .where('slug', '==', courseSlug)
                .limit(1)
                .get();
            
            if (!coursesSnapshot.empty) {
                const doc = coursesSnapshot.docs[0];
                course = { id: doc.id, ...doc.data() };
                currentCourseId = doc.id; // حدث الـ ID
            }
        }
        
        // إذا لم تجد بالـ slug، جرب بالـ ID
        if (!course && courseId) {
            const doc = await firebase.firestore()
                .collection('courses')
                .doc(courseId)
                .get();
            
            if (doc.exists) {
                course = { id: doc.id, ...doc.data() };
            }
        }
        
        if (!course) {
            throw new Error('الدورة غير موجودة');
        }
        
        // تحديث العنوان
        document.title = `${course.title} - معاينة - منظور الفؤاد`;
        
        // تحديث البيانات في الصفحة
        updateCourseUI(course);
        
    } catch (error) {
        console.error('Error loading course:', error);
        Swal.fire({
            icon: 'error',
            title: 'خطأ في تحميل الدورة',
            text: error.message,
            confirmButtonColor: '#f4c430'
        }).then(() => {
            window.location.href = './courses.html';
        });
    }
}

    // تحديث واجهة المستخدم بالبيانات
    function updateCourseUI(course) {
        // Hero Section
        document.querySelector('.course-title').textContent = course.title || 'دورة بدون عنوان';
        document.querySelector('.course-subtitle').textContent = course.subtitle || '';
        document.querySelector('.course-category').textContent = course.category || 'تطوير الذات';
        
        // تحديث الصورة
        if (course.thumbnailUrl) {
            document.querySelector('.hero-background').style.backgroundImage = `url(${course.thumbnailUrl})`;
        }
        
        // معلومات المدرب
        document.querySelector('.instructor-details h4').textContent = course.instructorName || 'المدرب';
        document.querySelector('.instructor-details p').textContent = course.instructorBio || '';
        
        // About Section
        const descriptionElement = document.querySelector('.description-content');
        if (course.detailedDescription) {
            descriptionElement.innerHTML = course.detailedDescription;
        }
        
        // Learning Objectives
        if (course.objectives && course.objectives.length > 0) {
            const objectivesGrid = document.querySelector('.objectives-grid');
            objectivesGrid.innerHTML = course.objectives.map((obj, index) => `
                <div class="objective-item">
                    <div class="objective-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <div>
                        <h4>هدف ${index + 1}</h4>
                        <p>${obj}</p>
                    </div>
                </div>
            `).join('');
        }
        
        // Curriculum
        if (course.modules && course.modules.length > 0) {
            const curriculumSection = document.querySelector('.curriculum-section');
            const modulesHTML = course.modules.map((module, index) => `
                <div class="module-item ${index === 0 ? 'expanded' : ''}">
                    <div class="module-header" onclick="toggleModule(this)">
                        <div class="module-title">
                            <div class="module-number">${index + 1}</div>
                            <div class="module-info">
                                <h3>${module.title}</h3>
                                <p>${module.lessons ? module.lessons.length : 0} دروس</p>
                            </div>
                        </div>
                        <div class="module-meta">
                            <span><i class="fas fa-video"></i> ${module.lessons ? module.lessons.length : 0} دروس</span>
                            <span><i class="fas fa-clock"></i> ${calculateModuleDuration(module)} دقيقة</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                    <div class="module-content">
                        ${module.lessons ? module.lessons.map(lesson => `
                            <div class="lesson-item" onclick="playLesson('${lesson.id}')">
                                <div class="lesson-icon">
                                    <i class="fas ${getLessonIcon(lesson.type)}"></i>
                                </div>
                                <div class="lesson-info">
                                    <div class="lesson-title">${lesson.title}</div>
                                    <div class="lesson-duration">${lesson.duration || 0} دقيقة</div>
                                </div>
                                <div class="lesson-status"></div>
                            </div>
                        `).join('') : '<p style="text-align: center; color: var(--text-muted);">لا توجد دروس بعد</p>'}
                    </div>
                </div>
            `).join('');
            
            curriculumSection.innerHTML = `
                <h2 class="section-title">
                    <i class="fas fa-list"></i>
                    منهج الدورة
                </h2>
                ${modulesHTML}
            `;
        }
        
        // السعر
        if (course.priceType === 'paid' && course.price) {
            document.querySelector('.price-value').innerHTML = `
                ${course.price} <span class="price-currency">ر.س</span>
            `;
            
            if (course.salePrice) {
                document.querySelector('.original-price').textContent = `${course.price} ر.س`;
                document.querySelector('.price-value').innerHTML = `
                    ${course.salePrice} <span class="price-currency">ر.س</span>
                `;
                const discount = Math.round((1 - course.salePrice / course.price) * 100);
                document.querySelector('.discount-badge').textContent = `خصم ${discount}%`;
            }
        } else if (course.priceType === 'free') {
            document.querySelector('.price-value').innerHTML = 'مجاناً';
            document.querySelector('.original-price').style.display = 'none';
            document.querySelector('.discount-badge').style.display = 'none';
        }
        
        // تحديث أزرار التحكم
        document.querySelector('.btn-secondary[href*="course-builder"]').href = `./course-builder.html?id=${course.id}`;
        
        // إخفاء حالة التحميل
        hideLoadingState();
    }

    // دوال مساعدة
    function calculateModuleDuration(module) {
        if (!module.lessons) return 0;
        return module.lessons.reduce((total, lesson) => total + (lesson.duration || 0), 0);
    }

    function getLessonIcon(type) {
        const icons = {
            video: 'fa-video',
            text: 'fa-file-alt',
            quiz: 'fa-question-circle',
            assignment: 'fa-tasks',
            resource: 'fa-download',
            live: 'fa-broadcast-tower'
        };
        return icons[type] || 'fa-file';
    }

    function showLoadingState() {
        // يمكنك إضافة مؤشر تحميل هنا
        document.querySelector('.preview-frame').style.opacity = '0.5';
    }

    function hideLoadingState() {
        // إخفاء مؤشر التحميل
        document.querySelector('.preview-frame').style.opacity = '1';
    }

    // تبديل الجهاز
    function setDevice(device) {
        currentDevice = device;
        const container = document.getElementById('previewContainer');
        const buttons = document.querySelectorAll('.device-btn');
        
        // تحديث الأزرار
        buttons.forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        
        // تحديث العرض
        container.classList.remove('tablet-view', 'mobile-view');
        if (device === 'tablet') {
            container.classList.add('tablet-view');
        } else if (device === 'mobile') {
            container.classList.add('mobile-view');
        }
    }

    // عرض التبويب
    function showTab(tabName) {
        currentTab = tabName;
        
        // تحديث الأزرار
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');
        
        // تحديث المحتوى
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(`${tabName}-tab`).classList.add('active');
    }

    // تبديل الوحدات
    function toggleModule(header) {
        const module = header.parentElement;
        module.classList.toggle('expanded');
    }

    // تبديل الأسئلة الشائعة
    function toggleFAQ(question) {
        const faqItem = question.parentElement;
        const wasActive = faqItem.classList.contains('active');
        
        // إغلاق جميع الأسئلة
        document.querySelectorAll('.faq-item').forEach(item => {
            item.classList.remove('active');
        });
        
        // فتح السؤال المحدد
        if (!wasActive) {
            faqItem.classList.add('active');
        }
    }

    // تشغيل الدرس
    function playLesson(lessonId) {
        const modal = document.getElementById('videoModal');
        const title = event.target.closest('.lesson-item').querySelector('.lesson-title').textContent;
        
        document.getElementById('videoTitle').textContent = title;
        modal.classList.add('active');
        
        // تشغيل الفيديو
        if (videoPlayer) {
            videoPlayer.play();
        }
    }

    // إغلاق الفيديو
    function closeVideo() {
        const modal = document.getElementById('videoModal');
        modal.classList.remove('active');
        
        if (videoPlayer) {
            videoPlayer.pause();
        }
    }

    // وظائف الأدمن
    function toggleStudentView() {
        alert('معاينة كطالب - قريباً');
    }

    function showAnalytics() {
        alert('تحليلات الدورة - قريباً');
    }

    function editCourse() {
        if (currentCourseId) {
            window.location.href = `./course-builder.html?id=${currentCourseId}`;
        }
    }

    function toggleSettings() {
        alert('إعدادات الدورة - قريباً');
    }

    function publishCourse() {
        if (confirm('هل أنت متأكد من نشر الدورة؟')) {
            if (currentCourseId) {
                window.firebaseDB.courses.publishCourse(currentCourseId).then(() => {
                    Swal.fire({
                        icon: 'success',
                        title: 'تم النشر بنجاح!',
                        text: 'الدورة متاحة الآن للطلاب',
                        confirmButtonColor: '#f4c430'
                    });
                }).catch(error => {
                    Swal.fire({
                        icon: 'error',
                        title: 'خطأ في النشر',
                        text: error.message,
                        confirmButtonColor: '#f4c430'
                    });
                });
            }
        }
    }

    function goBack() {
        window.location.href = './courses.html';
    }

    // إغلاق الفيديو عند النقر خارجه
    document.getElementById('videoModal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeVideo();
        }
    });
</script>
</body>
</html>
