<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    
    <!-- Ø¥Ø¶Ø§ÙØ© favicon Ù„ØªØ¬Ù†Ø¨ Ø®Ø·Ø£ 404 -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“</text></svg>">
    
    <!-- Ø§Ù„Ø®Ø·ÙˆØ· -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- EmailJS -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <!-- SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        :root {
            --gold-primary: #FFD700;
            --dark-bg: #0A1628;
            --dark-card: #152238;
            --success: #22C55E;
            --danger: #E11D48;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: var(--dark-bg);
            color: white;
            padding: 20px;
        }
        
        .booking-form-container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .form-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .form-header h2 {
            color: var(--gold-primary);
            margin-bottom: 10px;
        }
        
        .form-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 215, 0, 0.05);
            border-radius: 15px;
        }
        
        .form-section h4 {
            color: var(--gold-primary);
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            color: #94a3b8;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-control, .form-select {
            background: var(--dark-bg);
            color: white;
            border: 2px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            padding: 12px;
            transition: all 0.3s;
        }
        
        .form-control:focus, .form-select:focus {
            background: var(--dark-bg);
            color: white;
            border-color: var(--gold-primary);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }
        
        .price-summary {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }
        
        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .price-row.total {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--gold-primary);
            border-top: 2px solid rgba(255, 215, 0, 0.3);
            padding-top: 10px;
            margin-top: 10px;
        }
        
        .btn-submit {
            width: 100%;
            background: linear-gradient(135deg, var(--gold-primary), #D4AF37);
            color: var(--dark-bg);
            border: none;
            border-radius: 50px;
            padding: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-submit:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
        }
        
        .btn-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading-spinner.active {
            display: block;
        }
        
        .success-message {
            display: none;
            background: rgba(34, 197, 94, 0.1);
            border: 2px solid var(--success);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .success-message.active {
            display: block;
        }
        
        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .payment-option {
            background: var(--dark-bg);
            border: 2px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .payment-option:hover {
            border-color: var(--gold-primary);
            transform: translateY(-3px);
        }
        
        .payment-option.selected {
            background: rgba(255, 215, 0, 0.1);
            border-color: var(--gold-primary);
        }
        
        .payment-option input[type="radio"] {
            display: none;
        }
        
        .payment-option i {
            font-size: 2rem;
            color: var(--gold-primary);
            margin-bottom: 10px;
            display: block;
        }

        .alert {
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .alert-warning {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            color: #ffc107;
        }
    </style>
</head>
<body>
    <div class="booking-form-container">
        <div class="form-header">
            <h2><i class="fas fa-shopping-cart"></i> Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø­Ø¬Ø²</h2>
            <p>Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥ØªÙ…Ø§Ù… Ø­Ø¬Ø²Ùƒ ÙÙŠ Ø§Ù„Ø±Ø­Ù„Ø©</p>
        </div>
        
        <!-- ØªÙ†Ø¨ÙŠÙ‡ Ø­ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… -->
        <div class="alert alert-warning">
            <i class="fas fa-info-circle"></i>
            <strong>ÙˆØ¶Ø¹ Ø§Ù„ØªØ¬Ø±Ø¨Ø©:</strong> Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø³ØªÙØ­ÙØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·.
        </div>
        
        <form id="bookingForm">
            <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø© -->
            <div class="form-section">
                <h4><i class="fas fa-graduation-cap"></i> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø­Ù„Ø©</h4>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ±Ø©</label>
                            <input type="text" class="form-control" id="courseName" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¬Ø²</label>
                            <input type="text" class="form-control" id="bookingType" readonly>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© -->
            <div class="form-section">
                <h4><i class="fas fa-user"></i> Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h4>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label>
                            <input type="text" class="form-control" id="fullName" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
                            <input type="tel" class="form-control" id="phone" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© *</label>
                            <select class="form-select" id="governorate" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
                                <option value="cairo">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
                                <option value="giza">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
                                <option value="alexandria">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
                                <option value="ismailia">Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©</option>
                                <option value="suez">Ø§Ù„Ø³ÙˆÙŠØ³</option>
                                <option value="port-said">Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯</option>
                                <option value="damietta">Ø¯Ù…ÙŠØ§Ø·</option>
                                <option value="dakahlia">Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</option>
                                <option value="sharqia">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
                                <option value="qalyubia">Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©</option>
                                <option value="kafr-sheikh">ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®</option>
                                <option value="gharbia">Ø§Ù„ØºØ±Ø¨ÙŠØ©</option>
                                <option value="menoufia">Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
                                <option value="beheira">Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
                                <option value="fayoum">Ø§Ù„ÙÙŠÙˆÙ…</option>
                                <option value="beni-suef">Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ</option>
                                <option value="minya">Ø§Ù„Ù…Ù†ÙŠØ§</option>
                                <option value="asyut">Ø£Ø³ÙŠÙˆØ·</option>
                                <option value="sohag">Ø³ÙˆÙ‡Ø§Ø¬</option>
                                <option value="qena">Ù‚Ù†Ø§</option>
                                <option value="luxor">Ø§Ù„Ø£Ù‚ØµØ±</option>
                                <option value="aswan">Ø£Ø³ÙˆØ§Ù†</option>
                                <option value="red-sea">Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±</option>
                                <option value="new-valley">Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
                                <option value="matrouh">Ù…Ø·Ø±ÙˆØ­</option>
                                <option value="north-sinai">Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡</option>
                                <option value="south-sinai">Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ -->
            <div class="form-section">
                <h4><i class="fas fa-credit-card"></i> Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</h4>
                <div class="payment-methods" id="paymentMethods">
                    <label class="payment-option">
                        <input type="radio" name="paymentMethod" value="cash" required>
                        <i class="fas fa-money-bill-wave"></i>
                        <div>Ø¯ÙØ¹ Ù†Ù‚Ø¯ÙŠ</div>
                    </label>
                    <label class="payment-option">
                        <input type="radio" name="paymentMethod" value="installments3" required>
                        <i class="fas fa-calendar-alt"></i>
                        <div>3 Ø£Ù‚Ø³Ø§Ø·</div>
                    </label>
                    <label class="payment-option">
                        <input type="radio" name="paymentMethod" value="installments6" required>
                        <i class="fas fa-calendar-check"></i>
                        <div>6 Ø£Ù‚Ø³Ø§Ø·</div>
                    </label>
                    <label class="payment-option">
                        <input type="radio" name="paymentMethod" value="vodafone" required>
                        <i class="fas fa-mobile-alt"></i>
                        <div>ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</div>
                    </label>
                </div>
            </div>
            
            <!-- Ù…Ù„Ø®Øµ Ø§Ù„Ø³Ø¹Ø± -->
            <div class="price-summary">
                <h4 style="color: var(--gold-primary); margin-bottom: 20px;">
                    <i class="fas fa-receipt"></i> Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨
                </h4>
                <div class="price-row">
                    <span>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:</span>
                    <span id="basePrice">0 Ø¬.Ù…</span>
                </div>
                <div class="price-row" id="discountRow" style="display:none;">
                    <span>Ø§Ù„Ø®ØµÙ…:</span>
                    <span id="discount" style="color: var(--success);">-0 Ø¬.Ù…</span>
                </div>
                <div class="price-row total">
                    <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                    <span id="totalPrice">0 Ø¬.Ù…</span>
                </div>
            </div>
            
            <!-- Ø±Ø³Ø§Ù„Ø© Ø¥Ø¶Ø§ÙÙŠØ© -->
            <div class="form-section">
                <h4><i class="fas fa-comment"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</h4>
                <textarea class="form-control" id="notes" rows="3" 
                    placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ùˆ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª..."></textarea>
            </div>
            
            <!-- Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· -->
            <div class="form-check mb-4">
                <input type="checkbox" class="form-check-input" id="terms" required>
                <label class="form-check-label" for="terms">
                    Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… ÙˆØ³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©
                </label>
            </div>
            
            <!-- Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
            <button type="submit" class="btn-submit" id="submitBtn">
                <i class="fas fa-check-circle"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
            </button>
            
            <!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
            <div class="loading-spinner" id="loadingSpinner">
                <div class="spinner-border text-warning" role="status">
                    <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</span>
                </div>
                <p class="mt-2">Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ...</p>
            </div>
            
            <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ -->
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle" style="font-size: 3rem; color: var(--success);"></i>
                <h3 class="mt-3">ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!</h3>
                <p>Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø© Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</p>
                <p>Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²: <strong id="bookingNumber"></strong></p>
            </div>
        </form>
    </div>
    
    <script>
        // ==================== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ====================
        
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª EmailJS (Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© - Ø¶Ø¹ Ù…ÙØªØ§Ø­Ùƒ Ù‡Ù†Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§)
        const EMAILJS_PUBLIC_KEY = ""; // Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±Øº Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† ØªØ±ÙŠØ¯ EmailJS
        const EMAILJS_SERVICE_ID = "";
        const EMAILJS_CUSTOMER_TEMPLATE = "";
        const EMAILJS_ADMIN_TEMPLATE = "";
        
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Google Sheets (Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©)
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbyEnBu0CJ4kdzHPRvL9ff8JK8ioebrSw4ztuvNgGb0FHATTzrPVXmZRoWOYR2GA3fp3qA/exec'; // Ø¶Ø¹ Ø±Ø§Ø¨Ø· Web App Ù‡Ù†Ø§
        
        // ==================== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ====================
        let bookingData = {
            courseId: '',
            courseName: '',
            bookingType: '',
            basePrice: 0,
            discount: 0,
            totalPrice: 0,
            paymentMethod: '',
            userData: {}
        };
        
        // ==================== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ====================
        
        // Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø© Ù…Ù† URL
        function getBookingInfo() {
            const urlParams = new URLSearchParams(window.location.search);
            
            bookingData.courseId = urlParams.get('course') || 'default';
            bookingData.courseName = urlParams.get('name') || 'Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©';
            bookingData.bookingType = urlParams.get('type') || 'individual';
            bookingData.basePrice = parseInt(urlParams.get('price')) || 1000;
            bookingData.discount = parseInt(urlParams.get('discount')) || 0;
            bookingData.totalPrice = parseInt(urlParams.get('total')) || bookingData.basePrice - bookingData.discount;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            updateUI();
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function updateUI() {
            document.getElementById('courseName').value = decodeURIComponent(bookingData.courseName);
            document.getElementById('bookingType').value = getBookingTypeText(bookingData.bookingType);
            document.getElementById('basePrice').textContent = `${bookingData.basePrice.toLocaleString('ar-EG')} Ø¬.Ù…`;
            
            if (bookingData.discount > 0) {
                document.getElementById('discountRow').style.display = 'flex';
                document.getElementById('discount').textContent = `-${bookingData.discount.toLocaleString('ar-EG')} Ø¬.Ù…`;
            }
            
            document.getElementById('totalPrice').textContent = `${bookingData.totalPrice.toLocaleString('ar-EG')} Ø¬.Ù…`;
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¬Ø²
        function getBookingTypeText(type) {
            const types = {
                'individual': 'Ø±Ø­Ù„Ø© ÙØ±Ø¯ÙŠØ©',
                'group': 'Ø±Ø­Ù„Ø© Ø¬Ù…Ø§Ø¹ÙŠØ©',
                'gift': 'Ø¥Ù‡Ø¯Ø§Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©',
                'support': 'Ø±Ø­Ù„Ø© Ø¨Ø§Ù„Ø¯Ø¹Ù…'
            };
            return types[type] || 'Ø±Ø­Ù„Ø© ÙØ±Ø¯ÙŠØ©';
        }
        
        // ==================== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ====================
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ø®ØªÙŠØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹
        document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
            radio.addEventListener('change', function() {
                document.querySelectorAll('.payment-option').forEach(option => {
                    option.classList.remove('selected');
                });
                this.parentElement.classList.add('selected');
                bookingData.paymentMethod = this.value;
            });
        });
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        document.getElementById('bookingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            bookingData.userData = {
                fullName: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                governorate: document.getElementById('governorate').value,
                notes: document.getElementById('notes').value,
                termsAccepted: document.getElementById('terms').checked
            };
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!validateForm()) {
                return;
            }
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
            showLoading(true);
            
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù‚Ù… Ø­Ø¬Ø² ÙØ±ÙŠØ¯
                const bookingId = 'BOOK' + Date.now();
                
                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
                await saveBookingLocally(bookingId);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªØ§Ø­Ø©)
                await saveToExternalServices(bookingId);
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
                showSuccess(bookingId);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø­Ø¬Ø²:', error);
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ. ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹.');
            } finally {
                showLoading(false);
            }
        });
        
        // ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­ÙØ¸ ====================
        
        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
        async function saveBookingLocally(bookingId) {
            const bookingRecord = {
                bookingId: bookingId,
                courseId: bookingData.courseId,
                courseName: bookingData.courseName,
                bookingType: bookingData.bookingType,
                pricing: {
                    basePrice: bookingData.basePrice,
                    discount: bookingData.discount,
                    totalPrice: bookingData.totalPrice
                },
                paymentMethod: bookingData.paymentMethod,
                customer: bookingData.userData,
                status: 'pending',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            // Ø­ÙØ¸ ÙÙŠ localStorage
            const existingBookings = JSON.parse(localStorage.getItem('bookings') || '[]');
            existingBookings.push(bookingRecord);
            localStorage.setItem('bookings', JSON.stringify(existingBookings));
            
            // Ø­ÙØ¸ Ø£ÙŠØ¶Ø§Ù‹ ØªØ­Øª Ù…ÙØªØ§Ø­ Ù…Ù†ÙØµÙ„ Ù„Ù„Ø­Ø¬Ø² Ø§Ù„Ø­Ø§Ù„ÙŠ
            localStorage.setItem(`booking_${bookingId}`, JSON.stringify(bookingRecord));
            
            console.log('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø­Ø¬Ø² Ù…Ø­Ù„ÙŠØ§Ù‹:', bookingRecord);
        }
        
        // Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©
        async function saveToExternalServices(bookingId) {
            const promises = [];
            
            // Google Sheets (Ø¥Ø°Ø§ ÙƒØ§Ù† URL Ù…ÙˆØ¬ÙˆØ¯)
            if (GOOGLE_SHEETS_URL && GOOGLE_SHEETS_URL.trim() !== '') {
                promises.push(saveToGoogleSheets(bookingId));
            }
            
            // EmailJS (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø©)
            if (EMAILJS_PUBLIC_KEY && EMAILJS_PUBLIC_KEY.trim() !== '') {
                promises.push(sendConfirmationEmail(bookingId));
            }
            
            // Ø§Ù†ØªØ¸Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª (Ù…Ø¹ ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡)
            const results = await Promise.allSettled(promises);
            
            results.forEach((result, index) => {
                if (result.status === 'rejected') {
                    console.warn(`ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø© ${index + 1}:`, result.reason);
                }
            });
        }
        
        // Ø­ÙØ¸ ÙÙŠ Google Sheets
        async function saveToGoogleSheets(bookingId) {
            const data = {
                bookingId: bookingId,
                timestamp: new Date().toLocaleString('ar-EG'),
                courseName: bookingData.courseName,
                bookingType: getBookingTypeText(bookingData.bookingType),
                fullName: bookingData.userData.fullName,
                email: bookingData.userData.email,
                phone: bookingData.userData.phone,
                governorate: bookingData.userData.governorate,
                paymentMethod: bookingData.paymentMethod,
                basePrice: bookingData.basePrice,
                discount: bookingData.discount,
                totalPrice: bookingData.totalPrice,
                notes: bookingData.userData.notes || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯',
                status: 'Ø¬Ø¯ÙŠØ¯'
            };
            
            const response = await fetch(GOOGLE_SHEETS_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });
            
            console.log('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù€ Google Sheets');
        }
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„ØªØ£ÙƒÙŠØ¯
        async function sendConfirmationEmail(bookingId) {
            if (typeof emailjs === 'undefined') {
                throw new Error('EmailJS ØºÙŠØ± Ù…Ø­Ù…Ù„');
            }
            
            // ØªÙ‡ÙŠØ¦Ø© EmailJS
            emailjs.init(EMAILJS_PUBLIC_KEY);
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨
            const templateParams = {
                to_name: bookingData.userData.fullName,
                to_email: bookingData.userData.email,
                booking_id: bookingId,
                course_name: bookingData.courseName,
                total_price: bookingData.totalPrice,
                payment_method: bookingData.paymentMethod,
                phone: bookingData.userData.phone,
                governorate: bookingData.userData.governorate,
                notes: bookingData.userData.notes || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'
            };
            
            // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„
            if (EMAILJS_CUSTOMER_TEMPLATE) {
                await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_CUSTOMER_TEMPLATE, templateParams);
            }
            
            // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©
            if (EMAILJS_ADMIN_TEMPLATE) {
                await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_ADMIN_TEMPLATE, templateParams);
            }
            
            console.log('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„ØªØ£ÙƒÙŠØ¯');
        }
        
        // ==================== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Ø¹Ø±Ø¶ ====================
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function validateForm() {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(bookingData.userData.email)) {
                showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­');
                return false;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…ØµØ±ÙŠ
            const phoneRegex = /^01[0-2,5]\d{8}$/;
            if (!phoneRegex.test(bookingData.userData.phone.replace(/\s+/g, ''))) {
                showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…ØµØ±ÙŠ ØµØ­ÙŠØ­ (Ù…Ø«Ø§Ù„: 01012345678)');
                return false;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹
            if (!bookingData.paymentMethod) {
                showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹');
                return false;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·
            if (!bookingData.userData.termsAccepted) {
                showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…');
                return false;
            }
            
            return true;
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        function showLoading(show) {
            const spinner = document.getElementById('loadingSpinner');
            const submitBtn = document.getElementById('submitBtn');
            
            if (show) {
                spinner.classList.add('active');
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...';
            } else {
                spinner.classList.remove('active');
                submitBtn.disabled = false;
                submitBtn.
